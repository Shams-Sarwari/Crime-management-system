{% comment %}
{% block content %}
          <!-- driver detatil -->
      <!-- profile and jawazsair -->
      <div
        class="relative flex flex-col gap-y-4 gap-x-8 md:flex-row md:max-w-[960px] mx-2 md:mx-auto mt-2 md:mt-4 pb-6 pt-4 bg-white text-gray-500 rounded-lg shadow">
        <!-- dropdown -->
        <div class="absolute right-6 top-2">
          <button onclick="toggleProfileDropdown()"
            class="inline-block text-gray-500 hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg text-sm p-1.5"
            type="button">
            <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor"
              viewBox="0 0 16 3">
              <path
                d="M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z" />
            </svg>
          </button>
          <!-- Dropdown menu -->
          <div id="profile-dropdown"
            class="hidden absolute -right-2 top-10 z-10  list-none bg-white divide-y divide-gray-100 rounded-lg shadow w-36">
            <ul class="py-2 text-xs">
              <li>
                <a href="{% url "edit-driver-profile" driver.id %}" class="block px-4 py-2 text-gray-700 hover:bg-gray-100  ">ویرایش</a>
              </li>
              <li>
                <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100  ">نمایش عکس تذکره</a>
              </li>
              <li>
                <a href="#" onclick="printPage(); return false;" class="block px-4 py-2 text-gray-700 hover:bg-gray-100  ">چاپ اطلاعات</a>
              </li>
              
              <li>
                <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100  ">ایجاد جواز سیر</a>
              </li>
              {% if jawaz_sayr %}
              <li>
                <a href="{% url "cars:update-jawaz" jawaz_sayr.id %}" class="block px-4 py-2 text-green-600 hover:bg-gray-100  ">ویرایش جواز سیر</a>
              </li>
              {% endif %}
              
              <li>
                <a href="{% url "password_change" %}" class="block px-4 py-2 text-gray-700 hover:bg-gray-100  ">تبدیل رمز عبور</a>
              </li>
            </ul>
          </div>
        </div>
        <!-- profile card -->
        <div class="w-full max-w-md px-4">
          <div class="flex flex-col items-center gap-2 mt-6">
            <div class="w-20 h-20 md:w-24 md:h-24 overflow-hidden">
              <img src="{{ driver.avatar.url }}" alt="Image" class="object-contain h-auto rounded-full">
            </div>
            <div class="flex flex-col gap-1">
              <h2 class="text-xl text-color-primary font-semibold">{{ driver.first_name}} {{ driver.last_name }}</h2>
              <p class="text-sm">نمبر لایسنس: <span>{{ driver.licence_num }}</span></p>
            </div>
          </div>
          <!-- table and btns-->
          <div class="px-6 mt-4">
            <table class="text-[13px] text-gray-600 w-full">
              <tr class="bg-gray-200  h-7">
                <td class="pr-4 w-36 ">نام</td>
                <td>{{ driver.first_name }}</td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">تخلص</td>
                <td>{{ driver.last_name }}</td>
              </tr>
              <tr class="bg-gray-200 h-7">
                <td class="pr-4  ">نام پدر</td>
                <td>{{ driver.father_name }}</td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">جنسیت</td>
                <td>{{ driver.gender }}</td>
              </tr>
              <tr class="bg-gray-200 h-7">
                <td class="pr-4  ">گروپ خون</td>
                <td class="text-sm">{{ driver.blood_group }}</td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">نمبر لایسنس</td>
                <td class="text-sm">{{ driver.licence_num }}</td>
              </tr>
              <tr class="bg-gray-200 h-7">
                <td class="pr-4  ">نمبر تذکره</td>
                <td class="text-sm">{{ driver.tazkira_num }}</td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">شماره تماس</td>
                <td>{{ driver.phone_num }}</td>
              </tr>
              <tr class="bg-gray-200 h-7">
                <td class="pr-4  ">آدرس فعلی</td>
                <td>{{ driver.current_address.province }} {{ driver.current_address.district }}
                    {% if driver.current_address.street %}{{ driver.current_address.street }}{% endif %} 
                    {% if driver.current_address.house_number %}{{ driver.current_address.house_number}}{% endif %}
                </td>
              </tr>
            </table>
            <!-- btns -->
            <div class="flex justify-center gap-6 mt-8">
              <button type="button" onclick="window.open('{% url "cars:create-car-with-driver" driver.id %}', '_self');"
                class="text-white bg-color-primary hover:bg-color-primary-lighter focus:ring-4 focus:outline-none focus:ring-red-300 rounded text-sm w-24 py-1 text-center">
                ثبت موتر
              </button>
              <button type="button" onclick="showDeleteNotification()"
                class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 rounded text-sm w-24 py-1 text-center">
                حذف
              </button>
            </div>
          </div>

        </div>
        <!-- jawazsair card -->
        <div class="w-full max-w-md px-10 md:pr-14 mt-4 text-gray-600 md:border-r">
          <h2 class="mr-2 pb-2 text-lg text-color-primary font-semibold">مشخصات جواز سیر</h2>
          <table class="w-full text-[13px] border-t-2 border-b-2 border-gray-400">
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">نمبر جواز</td>
              <td class="text-sm">{{ jawaz_sayr.jawaz_num }}</td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">نمبر کارت</td>
              <td class="text-sm">{{ jawaz_sayr.card_num }}</td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">نمبر احصاییه</td>
              <td class="text-sm">{{ jawaz_sayr.statistic_num }}</td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">نمبر مکتوب</td>
              <td class="text-sm">{{ jawaz_sayr.document_num }}</td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">تاریخ مکتوب</td>
              <td>{{ jawaz_sayr.document_date }} </td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">نمبر علم و خبر</td>
              <td class="text-sm">{{ jawaz_sayr.news_num }}</td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">تاریخ علم و خبر</td>
              <td> {{ jawaz_sayr.news_date }} </td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">نمبر تعرفه بانک </td>
              <td class="text-sm">{{ jawaz_sayr.bank_reg_num }}</td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">تاریخ تعرفه بانک</td>
              <td>{{ jawaz_sayr.bank_reg_date }}</td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">سایز</td>
              <td class="text-sm">{{ jawaz_sayr.size }}</td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 "> اطمینانه مستوفیت </td>
              <td>{{ jawaz_sayr.rest_assured }}</td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">تایید شده توسط </td>
              <td>{{ jawaz_sayr.verified_by }} </td>
            </tr>
            <tr class="border-b h-8">
              <td class="pr-4 w-36 ">تاریخ صدور</td>
              <td>{{ jawaz_sayr.created}} </td>
            </tr>
            <tr class="h-8">
              <td class="pr-4 w-36 ">تاریخ انقضا</td>
              <td>{{ jawaz_sayr.expiry_date}}  </td>
            </tr>
          </table>
        </div>

      </div>
      <!-- End profile and jawazsair -->

      {% for car in cars %}
      <!-- car and payment -->
      <div
        class="max-w-md md:max-w-[960px] mx-2 md:mx-auto mt-4 mb-4 md:mb-10 bg-white text-gray-600 rounded-lg shadow overflow-hidden">
        <!-- car name and plateNO -->
        <div class="flex justify-between bg-color-primary text-white py-4 px-2 md:px-10">
          <div class="flex gap-x-4 md:gap-x-10 text-lg">
            <span>{{ forloop.counter }}</span>
            <span>{{ car.model }}</span>
            <span>{{ car.plate_number }}</span>
          </div>
          <div onclick="toggleCarInfo()" class="flex items-center cursor-pointer text-xs md:text-sm">
            <span class="ml-2">جزییات موتر</span><i class="fa-solid fa-angle-down inline-block "></i>
          </div>
        </div>
        <!-- car info -->
        <div id="car-info" class="max-w-md md:max-w-full px-10 pb-4 border-b hidden">
          <h3 class="my-4 text-lg text-center text-color-primary font-semibold">مشخصات موتر</h3>
          <div class="flex flex-col md:flex-row">
            <table class="text-[13px] text-gray-600 w-full ">
              <tr class="bg-gray-200  h-7">
                <td class="pr-4 w-36 ">مالک</td>
                <td> {{ car.owner }}</td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">راننده</td>
                <td>{{ car.driver.first_name }} {{ car.driver.last_name }} </td>
              </tr>
              <tr class="bg-gray-200  h-7">
                <td class="pr-4 w-36 ">نمبر پلیت</td>
                <td>{{ car.plate_number }} </td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">مودل</td>
                <td>{{ car.model }} </td>
              </tr>
              <tr class="bg-gray-200  h-7">
                <td class="pr-4  ">وزن مجاز</td>
                <td>{{ car.legal_weight }} کیلوگرام</td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">تعداد راکبین</td>
                <td>{{ car.number_of_rider }} نفر</td>
              </tr>
            </table>

            <table class="text-[13px] text-gray-600 w-full md:mr-10">
              <tr class="bg-gray-200  h-7">
                <td class="pr-4 w-36 ">رنگ</td>
                <td> {{ car.color }}</td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">نوع اشترینگ</td>
                <td>{{ car.steering }}</td>
              </tr>
              <tr class="bg-gray-200  h-7">
                <td class="pr-4 w-36 "> نوع ماشین</td>
                <td>{{ car.engine_type }}</td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">نمبر ماشین</td>
                <td>{{ car.engine_num }}</td>
              </tr>
              <tr class="bg-gray-200  h-7">
                <td class="pr-4  ">نمبر شاسی</td>
                <td>{{ car.chassis_num }}</td>
              </tr>
              <tr class=" h-7">
                <td class="pr-4  ">تعداد سلندر</td>
                <td>{{ car.number_of_cylinder }} سلندر</td>
              </tr>
            </table>
          </div>
        </div>
        <!-- punishment -->
        <form class="px-2 md:px-10 py-6 relative">
          <input type="checkbox" name="" id="masterCheckbox"
            class="absolute top-10 right-6 md:right-[54px] cursor-pointer">
          <table id="fineTable">
            <tr class="h-12 text-center text-gray-600 text-[13px] font-semibold border-b border-gray-500">
              <td class="w-10 h-12 flex justify-center items-center">
              </td>
              <td class=" w-72">نوع جریمه</td>
              <td class="w-32">مقدار جریمه</td>
              <td class=" w-40">جریمه عدم پرداخت</td>
              <td class="w-32">مقدار کُل</td>
              <td class=" w-32">تاریخ انقضا</td>
            </tr>
            
            <tr class="h-12 text-center text-gray-600 border-b border-gray-300">
              <td class="w-10 h-12 flex justify-center items-center"><input type="checkbox" name=""
                  class=" cursor-pointer">
              </td>
              <td class="text-[13px]"> {{ crime.crime.title }}</td>
              <td>{{ crime.price }}</td>
              <td>{{ crime.expiry_fine }}</td>
              <td>{{ crime.get_total }}</td>
              <td>{{ crime.expiry_date }}</td>
            </tr>
            {% endif %} 
            {% endfor %}
            
          </table>
          <div class="flex justify-between mt-16">
            <label class="font-semibold pr-4">مقدار کُل : <span id="total" class="text-lg">00</span></label>
            <input type="submit" value="پرداخت"
              class="text-white bg-color-primary hover:bg-color-primary-lighter focus:ring-4 focus:outline-none rounded text-sm w-36 py-2 text-center cursor-pointer">
          </div>
        </form>
      </div>
      <!-- end car and plateNo -->
      {% endfor %}
    </section>
{% endblock content %}

{% block jscript %}
  <!-- *************************************** -->
  <!-- ********* Delete Notification **************** -->
  <!-- Confirm Delete with blur functionality -->
  <div id="confirm-delete-container" class="hidden absolute top-0 bottom-0 right-0 left-0  backdrop-blur-sm p-2">
    <div class="center-div w-full max-w-sm max-h-full bg-white rounded-lg shadow">
      <button type="button" onclick="hideDeleteNotification()"
        class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ml-auto inline-flex justify-center items-center">
        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
        </svg>
      </button>
      <div class="p-6 text-center">
        <svg class="mx-auto mb-2 text-red-400 w-8 h-8" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
          viewBox="0 0 20 20">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
        </svg>
        <h3 class="mb-4 text-sm font-normal text-gray-500 leading-7">
          آیا مطمئن هستید که میخواهید این مورد را حذف کنید؟
        </h3>
        <form action="">
          <input type="submit" value="بله مطمئنم"
            class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 rounded-lg text-sm inline-flex items-center px-5 py-1 text-center ml-2 cursor-pointer">
          <a href="#" onclick="hideDeleteNotification()"
            class="inline-block w-28 text-gray-500 bg-white hover:bg-gray-100 hover:text-gray-900 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm px-5 py-1 focus:z-10">لغو</a>
        </form>
      </div>
    </div>
  </div>
  <!-- End confirm delete -->
  <script>
    // ****************************************
    // ********* profile details ****************
    const profile_dropdown = document.getElementById("profile-dropdown");
    function toggleProfileDropdown() {
      profile_dropdown.classList.toggle("hidden");
    }
    // ****************************************
    // ********* car info *****************
    const car_info = document.getElementById("car-info");
    function toggleCarInfo() {
      car_info.classList.toggle("hidden");
    }

    // ****************************************
    // ********* fine payment ****************
    const masterCheckbox = document.getElementById('masterCheckbox');
    const checkboxes = document.querySelectorAll('#fineTable input[type="checkbox"]');
    let sum = 0;

    masterCheckbox.addEventListener('change', function () {
      checkboxes.forEach((checkbox) => {
        checkbox.checked = this.checked;
      });

      calculateSum();
    });

    checkboxes.forEach((checkbox) => {
      checkbox.addEventListener('change', function () {
        calculateSum();
        synchronizeMasterCheckbox();
      });
    });

    function calculateSum() {
      sum = 0;
      checkboxes.forEach((checkbox) => {
        if (checkbox.checked) {
          const row = checkbox.parentNode.parentNode;
          const value = row.querySelector('td:nth-child(5)').textContent;
          sum += parseInt(value);
        }
      });

      document.getElementById('total').textContent = sum;
    }

    function synchronizeMasterCheckbox() {
      const allChecked = Array.from(checkboxes).every((checkbox) => checkbox.checked);
      masterCheckbox.checked = allChecked;
    }

    // *********************************************************
    // ************** Confirm Delete ****************************
    const confirm_delete_container = document.getElementById('confirm-delete-container');
    function showDeleteNotification() {
      confirm_delete_container.classList.remove("hidden");
    };
    function hideDeleteNotification() {
      confirm_delete_container.classList.add("hidden");
    };

  </script>
  <script>
    function printPage() {
        window.print();
    }
  </script>
{% endblock jscript %} {% endcomment %}